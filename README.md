# Assertions
Assertions is a framework for writing automated tests in C++.

## The project file tree
Assertions is build with a predefined file tree. Some folders of this tree can be changed by editing _CMakeLists.txt_, _build.sh_ and _test.sh_. The project tree is as follows:
* _build.sh_: script for building the project
* _build_: folder containing all build files generated by _build.sh_
* _src_: folder containing the source files of the project
	* _main_: contains source files which have an entry point. These files will be built as executables inside _build_
	* _objs_: contains headers and source files that have no entry point. This folder is added to your includes search path and source files contained here are used when building tests and _main_ executables
* _test.sh_: script for executing tests
* _tests_: folder containing all tests source files. Cannot be changed without also changing _test.sh_ 

## Running tests
To run already written tests, the _test.sh_ script should be run. Tests are automatically built if needed. The usage of the script is the following: 
```
./test.sh [all] | [space separated list of test names]
```
With the paramater _all_, all tests inside _tests_ are executed.

A test name can be one of the following:
* The name of a source file inside _tests_. Eg: test_something.cpp;
* The name of a source file inside _tests_ without the _test\__ prefix and _.cpp_ extension. Eg: something;
* The name of a test binary inside _build_. Eg: test_something;

Usage examples:
```
./test.sh
./test.sh all
```
Both will run all tests
```
./test.sh something
./test.sh test_something
./test.sh test_something.cpp
```
All three will run the test written in test\_something.cpp

Alternatively the test binaries can also be run directly but the output will not have as much information as when run from the script.

Tests can also be run using CTest, but the entire test file will be considered a single test as opposed to each test case being its own individual test.

## Building code
Assertions provides the script _build.sh_ for building code. Usage:
```
./build.sh [target] | [clean] | [cmake-only]
```
* _target_: Makefile target that should be built. With the default CMakeLists this will be the name of binary to be generated in _build_
* _clean_: Delete all build files
* _cmake_only_: Execute cmake but do not build the binaries

If no option is passed then all possible targets are built

## Writing tests
First step for writing a test is creating a _.cpp_ file inside _tests_. The file must be prefixed with _test\__ but cannot be prefixed with _test\_test\__.

The tests should be written inside a _main_ function. The main function does not need to return anything and does not take any arguments.

### Test case block
A test case block is a block specifing something to be tested. A test block must contain a message describing what is going to be tested. Eg:
```
test_case("whether this functionality works") {
	// test code goes here
} end_test_case;
```

### Asserting values
Assertions ensure that a test condition is met and if not will cause the test case to fail. The first value is the value to be tested and the second value is the value expected. These are the provided assert macros:
* _assert\_equal_: checks if two values are equal:
```
test_case("a equals 2") {
	int a = 2;
	assert_equal(a, 2);
} end_test_case;
```
* _assert\_not\_equal_: checks if two values are different:
```
test_case("a not equal 2") {
        int a = 3;
        assert_not_equal(a, 2);
} end_test_case;
```
* _assert\_greater\_than_: checks if a value is greater than another value:
```
test_case("a greater than 2") {
        int a = 3;
        assert_greater_than(a, 2);
} end_test_case;
```
* _assert\_less\_than_: checks if a value is less than another value:
```
test_case("a less than 2") {
        int a = 1;
        assert_less_than(a, 2);
} end_test_case;
```
* _assert\_greater\_than\_or\_equal_: checks if a value is greater than or equal another value:
```
test_case("a greater than or equal 1") {
        int a = 2;
        assert_greater_than_or_equal(a, 2);
	assert_greater_than_or_equal(a, 1);
} end_test_case;
```
* _assert\_less\_than\_or\_equal_: checks if a value is less than or equal another value:
```
test_case("a less than or equal 1") {
        int a = 1;
        assert_less_than_or_equal(a, 2);
	assert_less_than_or_equal(a, 1);
} end_test_case;
```
* _assert\_true_: checks if a logic expression is true. Useful for doing more complex assertions:
```
test_case("a in range [0, 3)") {
        int a = 2;
        assert_true(a >= 0 && a < 3);
} end_test_case;
```
## Weird build errors
Assertions makes heavy use of macros in order to generate code during compilation time. This means that if a test is badly written you will get compilation error messages referencing code you did not write explicitly. Eg:
```
int main (void) {
	test_case("missing brackets")
		assert_true(true);
	end_test_case;
}
```
The compiler will complain near a "try" keyword. Although you did not write this keyword anywhere, it is created during the expansion for the _test\_case_ macro



